-- PRIVATE SERVER FORCE REJOIN | Bee Swarm Simulator
-- EXTREME VERSION - Completely re-coded
-- CRITICAL: Place in AUTO-EXECUTE folder

local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local StarterGui = game:GetService("StarterGui")

-- ========== CONFIGURATION ==========
local PLACE_ID = 1537690962
local PRIVATE_SERVER_CODE = "16707204235853911608327042947697"
-- ===================================

-- Wait for CoreGui to be ready
repeat task.wait() until CoreGui:FindFirstChild('RobloxPromptGui')
local promptOverlay = CoreGui.RobloxPromptGui.promptOverlay

-- Function to FORCE teleport to private server
local function forceTeleportToPrivateServer()
    print("üö® FORCE TELEPORTING TO PRIVATE SERVER...")
    
    -- Try to prevent any user interaction
    pcall(function()
        promptOverlay.Enabled = false
        StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.All, false)
    end)
    
    -- Use the CORRECT function for private servers
    local success, err = pcall(function()
        TeleportService:TeleportToPrivateServer(PLACE_ID, PRIVATE_SERVER_CODE, {Players.LocalPlayer})
    end)
    
    if success then
        print("‚úÖ Teleport initiated successfully!")
    else
        warn("‚ùå Teleport failed: " .. tostring(err))
    end
    
    -- AGGRESSIVE retry every 2 seconds until it works
    while true do
        task.wait(2)
        pcall(function()
            TeleportService:TeleportToPrivateServer(PLACE_ID, PRIVATE_SERVER_CODE, {Players.LocalPlayer})
        end)
    end
end

-- Detect disconnection prompt
promptOverlay.ChildAdded:Connect(function(child)
    if child.Name == 'ErrorPrompt' then
        print("üö® DISCONNECTION DETECTED! Force rejoining private server...")
        
        -- Wait 0.5 seconds for the prompt to fully load
        task.wait(0.5)
        
        -- Call the force teleport function
        forceTeleportToPrivateServer()
    end
end)

-- Also detect if the prompt is already there (in case script loads after disconnect)
if promptOverlay:FindFirstChild('ErrorPrompt') then
    print("üö® Error prompt already detected! Force rejoining...")
    forceTeleportToPrivateServer()
end

print("‚úÖ PRIVATE SERVER FORCE REJOIN SCRIPT ACTIVE")
print("üéØ Target: " .. PRIVATE_SERVER_CODE)
print("üí° DO NOT click 'Reconnect' - let the script handle it!")
