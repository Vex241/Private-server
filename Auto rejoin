-- PRIVATE SERVER FORCE REJOIN | Bee Swarm Simulator
-- ULTIMATE METHOD: Override ALL teleport attempts to the game
-- CRITICAL: Place in AUTO-EXECUTE folder

local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")

-- ========== YOUR PRIVATE SERVER INFO ==========
local PLACE_ID = 1537690962
local PRIVATE_SERVER_CODE = "16707204235853911608327042947697"
-- =============================================

-- Deep override: Force ALL teleports to Bee Swarm Simulator to use private server
local originalTeleport = TeleportService.Teleport
local originalTeleportToPlaceInstance = TeleportService.TeleportToPlaceInstance

-- Override the main Teleport function (used by Reconnect button)
TeleportService.Teleport = function(self, placeId, player, teleportData, ...)
    if placeId == PLACE_ID then
        -- Inject private server code into ANY teleport to this game
        teleportData = teleportData or {}
        if type(teleportData) == "table" then
            teleportData.serverAccessCode = PRIVATE_SERVER_CODE
        end
        print("ðŸš¨ INTERCEPTED teleport to public! Forcing private server...")
        return originalTeleport(self, placeId, player, teleportData, ...)
    end
    return originalTeleport(self, placeId, player, teleportData, ...)
end

-- Override TeleportToPlaceInstance (another possible entry point)
TeleportService.TeleportToPlaceInstance = function(self, placeId, instanceId, player, teleportData, ...)
    if placeId == PLACE_ID and (not instanceId or instanceId == "") then
        -- If no specific instance, force private server
        print("ðŸš¨ INTERCEPTED teleport to public instance! Forcing private server...")
        return TeleportService:TeleportToPrivateServer(placeId, PRIVATE_SERVER_CODE, {player}, teleportData)
    end
    return originalTeleportToPlaceInstance(self, placeId, instanceId, player, teleportData, ...)
end

-- Backup: If the overrides fail, detect prompt and manually teleport
repeat task.wait() until CoreGui:FindFirstChild('RobloxPromptGui')
local promptOverlay = CoreGui.RobloxPromptGui.promptOverlay

local function manualForceTeleport()
    print("ðŸš€ MANUAL FORCE TELEPORT TO PRIVATE SERVER...")
    while true do
        task.wait(2)
        pcall(function()
            TeleportService:TeleportToPrivateServer(PLACE_ID, PRIVATE_SERVER_CODE, {Players.LocalPlayer})
        end)
    end
end

promptOverlay.ChildAdded:Connect(function(child)
    if child.Name == 'ErrorPrompt' then
        task.wait(0.5)
        print("ðŸš¨ Prompt detected! Starting manual teleport...")
        promptOverlay.Enabled = false -- Hide prompt
        manualForceTeleport()
    end
end)

if promptOverlay:FindFirstChild('ErrorPrompt') then
    promptOverlay.Enabled = false
    manualForceTeleport()
end

print("âœ… PRIVATE SERVER FORCE REJOIN IS ACTIVE")
print("ðŸŽ¯ All teleport attempts to game " .. PLACE_ID .. " will be forced to your private server")
print("ðŸ’¡ This includes the Reconnect button!")
print("ðŸ’¡ DO NOT click anything when disconnected - just wait!")
